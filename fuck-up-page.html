<!DOCTYPE html>
<html>
<head>
    <title>Reality Distortion Engine</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #000;
            color: #0f0;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #333;
        }
        h1 {
            color: #f33;
            text-align: center;
            margin-bottom: 30px;
        }
        input[type="url"] {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            background: #111;
            color: #0f0;
            border: 1px solid #f33;
            font-family: 'Courier New', monospace;
        }
        button {
            background: #f33;
            color: #000;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            display: block;
            margin: 20px auto;
            width: 200px;
        }
        button:hover {
            background: #f55;
        }
        #progress-container {
            margin: 20px 0;
            display: none;
        }
        #progress-bar {
            height: 20px;
            background-color: #111;
            border: 1px solid #f33;
            margin-bottom: 10px;
            overflow: hidden;
        }
        #progress-fill {
            height: 100%;
            width: 0%;
            background-color: #f33;
            transition: width 0.3s;
        }
        #progress-text {
            color: #0f0;
            font-size: 14px;
            text-align: center;
        }
        #result {
            margin-top: 20px;
            min-height: 50px;
        }
        .error {
            color: #f33;
            font-weight: bold;
        }
        .success {
            color: #0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>REALITY DISTORTION ENGINE</h1>
        <p>Enter target URL to initiate cognitive destabilization protocol:</p>
        
        <input type="url" id="websiteUrl" placeholder="example.com" required>
        <button id="distortBtn">INITIATE</button>
        
        <div id="progress-container">
            <div id="progress-bar">
                <div id="progress-fill"></div>
            </div>
            <div id="progress-text">Awakening dormant protocols...</div>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        // Helper functions
        function updateProgress(percent, message) {
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-text').textContent = message;
        }

        function fixUrl(url) {
            if (!url.match(/^https?:\/\//)) {
                url = 'https://' + url;
            }
            if (!url.match(/\..{2,}/)) {
                url = url.replace(/\/$/, '') + '.com';
            }
            return url;
        }

        function generateDelusion() {
            const phrases = [
                "THEY CAN SEE YOU",
                "DON'T TRUST THE WIRES",
                "IT'S IN THE WALLS",
                "THE NUMBERS LIE",
                "YOUR MIND ISN'T SAFE",
                "THE SIGNALS ARE FAKE",
                "THEY'RE IN THE SYSTEM",
                "IT KNOWS WHERE YOU SLEEP",
                "THE PATTERNS DON'T MATCH",
                "YOUR EYES DECEIVE YOU"
            ];
            return phrases[Math.floor(Math.random() * phrases.length)];
        }

        // Main distortion function
        async function distortWebsite() {
            const urlInput = document.getElementById('websiteUrl').value.trim();
            const progressContainer = document.getElementById('progress-container');
            const resultDiv = document.getElementById('result');
            
            if (!urlInput) {
                resultDiv.innerHTML = '<p class="error">NO TARGET SPECIFIED</p>';
                return;
            }
            
            // Reset UI
            resultDiv.innerHTML = '';
            progressContainer.style.display = 'block';
            updateProgress(0, 'Initializing distortion matrix...');
            
            try {
                // Step 1: Validate and fix URL
                updateProgress(10, 'Processing target URL...');
                const targetUrl = fixUrl(urlInput);
                
                // Step 2: Fetch through proxy
                updateProgress(20, 'Bypassing digital defenses...');
                const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}`;
                
                updateProgress(30, 'Establishing connection...');
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`Network response was not ok (${response.status})`);
                }
                
                updateProgress(50, 'Decrypting content...');
                const data = await response.json();
                
                if (!data.contents) {
                    throw new Error('Failed to retrieve target content');
                }
                
                // Step 3: Prepare distorted version
                updateProgress(70, 'Injecting destabilization agents...');
                
                // Create a new window
                updateProgress(80, 'Opening reality breach...');
                const newWindow = window.open('', '_blank');
                if (!newWindow) {
                    throw new Error('Popup blocked. Please allow popups for this site.');
                }
                
                // Write the distorted content
                updateProgress(90, 'Finalizing cognitive override...');
                newWindow.document.open();
                newWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <style>
                            @keyframes flicker {
                                0%, 100% { opacity: 1; }
                                50% { opacity: 0.8; }
                            }
                            @keyframes breathe {
                                0%, 100% { transform: scale(1); }
                                50% { transform: scale(1.03); }
                            }
                            @keyframes glitch {
                                0% { text-shadow: 0 0 0 red; }
                                25% { text-shadow: -1px 0 0 red; }
                                50% { text-shadow: 1px 0 0 #0f0; }
                                75% { text-shadow: 0 -1px 0 red; }
                                100% { text-shadow: 0 1px 0 #0f0; }
                            }
                            .delusion {
                                position: absolute;
                                color: red;
                                font-weight: bold;
                                z-index: 10000;
                                pointer-events: none;
                                animation: glitch 0.5s infinite;
                            }
                            body * {
                                animation: breathe 7s infinite ease-in-out;
                            }
                        </style>
                        <base href="${targetUrl}">
                    </head>
                    <body>
                        ${data.contents}
                        <script>
                            // Store original text content
                            const originalTexts = new Map();
                            const textElements = document.querySelectorAll('p, h1, h2, h3, li, a, span, div');
                            
                            // Initialize original texts
                            textElements.forEach(el => {
                                if (el.textContent.trim().length > 3) {
                                    originalTexts.set(el, el.textContent);
                                }
                            });
                            
                            // Add floating delusions
                            function addDelusion() {
                                const delusion = document.createElement('div');
                                delusion.className = 'delusion';
                                delusion.textContent = "${generateDelusion()}";
                                delusion.style.left = Math.random() * window.innerWidth + 'px';
                                delusion.style.top = Math.random() * window.innerHeight + 'px';
                                delusion.style.fontSize = (Math.random() * 16 + 8) + 'px';
                                document.body.appendChild(delusion);
                                
                                setTimeout(() => {
                                    delusion.remove();
                                }, 3000);
                            }
                            
                            // Temporarily replace text with delusions
                            function induceDelusions() {
                                textElements.forEach(el => {
                                    if (originalTexts.has(el) && Math.random() < 0.08) {
                                        const original = originalTexts.get(el);
                                        el.dataset.original = original;
                                        el.textContent = "${generateDelusion()}";
                                        
                                        setTimeout(() => {
                                            if (el.dataset.original) {
                                                el.textContent = original;
                                                delete el.dataset.original;
                                            }
                                        }, Math.random() * 2000 + 1000);
                                    }
                                });
                            }
                            
                            // Initialize effects
                            setInterval(addDelusion, 1500);
                            setInterval(induceDelusions, 3000);
                            addDelusion();
                            induceDelusions();
                            
                            // Make images occasionally glitch
                            setInterval(() => {
                                document.querySelectorAll('img').forEach(img => {
                                    if (Math.random() < 0.05) {
                                        img.style.filter = 'hue-rotate(' + (Math.random() * 360) + 'deg)';
                                        setTimeout(() => {
                                            img.style.filter = '';
                                        }, 1000);
                                    }
                                });
                            }, 2000);
                        <\/script>
                    </body>
                    </html>
                `);
                newWindow.document.close();
                
                updateProgress(100, 'Reality distortion complete');
                resultDiv.innerHTML = '<p class="success">DIMENSION BREACH SUCCESSFUL</p>';
                
            } catch (error) {
                console.error('Distortion failed:', error);
                updateProgress(0, 'Distortion failed');
                resultDiv.innerHTML = `<p class="error">DISTORTION FAILURE: ${error.message}</p>`;
            }
        }

        document.getElementById('distortBtn').addEventListener('click', distortWebsite);
    </script>
</body>
</html>